---
page_title: HCP Vault Secrets-Backed Dynamic Credentials - Dynamic Provider Credentials - Workspaces - HCP Terraform
description: >-
  HCP Vault Secrets-Backed dynamic credentials improve security by leveraging HCP Vault Secrets to generate
  temporary credentials for HCP Terraform runs. Configure HCP Vault Secrets-backed dynamic credentials
  for the AWS, and GCP providers.
---

# HCP Vault Secrets-Backed Dynamic Credentials

~> **Important:** If you are self-hosting [HCP Terraform agents](/terraform/cloud-docs/agents), ensure your agents use [v1.8.0](/terraform/cloud-docs/agents/changelog#1-8-0-04-18-2023) or above. To use the latest dynamic credentials features, [upgrade your agents to the latest version](/terraform/cloud-docs/agents/changelog).

For most use cases, separately configuring [dynamic provider credentials](/terraform/cloud-docs/workspaces/dynamic-provider-credentials) with different cloud providers works well. However, HCP Vault Secrets-backed dynamic credentials are for those looking for a way to:
 1. Use HCP's secrets engines as a centralized way to manage and consolidate cloud credentials management.
 2. Generate short-lived credentials without exposing their Terraform Enterprise instance's OIDC metadata endpoints to the broader public internet.

The "HCP Vault Secrets-backed" in "HCP Vault Secrets-backed dynamic credentials" refers to HCP Vault Secrets' [secrets engines](/hcp/docs/vault-secrets), which allow you to generate short-lived [dynamic secrets](/hcp/docs/vault-secrets/dynamic-secrets) for the AWS, or GCP providers.

HCP Vault Secrets-backed dynamic credentials combine the features of dynamic provider credentials and HCP Vault Secrets' secrets engines. This means you can authenticate a HCP instance using workload identity tokens and use secrets engines on that instance to generate dynamic credentials for the AWS, and GCP providers. 

To learn more about HCP Vault Secrets-backed dynamic credentials , refer to our [HCP Vault Secrets blog post](https://www.hashicorp.com/blog/hcp-vault-secrets-is-now-generally-available)

## Configure HCP Vault Secrets-Backed Dynamic Credentials

Using HCP Vault Secrets-backed dynamic credentials in a workspace requires the following steps for each cloud platform:

1. **Set up Dynamic Provider Credentials with the HCP Provider:** You must first [configure dynamic credentials with the HCP provider](/terraform/cloud-docs/workspaces/dynamic-provider-credentials/hcp-configuration).
2. **Configure the desired Secrets Engine**: You must configure the desired secrets engine in your HCP instance (i.e., AWS, or GCP).
3. **Configure HCP Terraform Workspace**: You must add specific environment variables to your workspace to tell HCP Terraform how to authenticate to other cloud providers during runs. Each cloud platform has its own set of environment variables that are necessary to configure dynamic credentials.

Setting up HCP Vault Secrets-backed dynamic credentials differs slightly for each cloud provider. You can configure HCP Vault Secrets-backed dynamic credentials on the following platforms:
- [Amazon Web Services](/terraform/cloud-docs/workspaces/dynamic-provider-credentials/hcp-vault-secrets-backed/aws-configuration)
- [Google Cloud Platform](/terraform/cloud-docs/workspaces/dynamic-provider-credentials/hcp-vault-secrets-backed/gcp-configuration)

## Terraform Enterprise Specific Requirements

### Access to Metadata Endpoints

In order to verify signed JWTs, HCP must have network access to the following static OIDC metadata endpoints within TFE:

1. `/.well-known/openid-configuration` - standard OIDC metadata.
2. `/.well-known/jwks` - TFEâ€™s public key(s) that cloud platforms use to verify the authenticity of tokens that claim to come from TFE.

These endpoints **do not** need to be publicly exposed as long as your HCP instance can access them.

### External Vault Policy

If you are using an external Vault instance, you must ensure that your HCP instance has the correct policies setup as detailed in the [External Vault Requirements for Terraform Enterprise](/terraform/enterprise/requirements/data-storage/vault) documentation.
